# Claude Memory System - Optional Docker Services
#
# NOTE: Most services now run natively for better performance:
#   - Ollama: brew services start ollama (Metal GPU acceleration)
#   - Memory Dashboard: ~/.claude-dash/dashboard/start.sh
#   - File Watcher: ~/.claude-dash/watcher/start-watcher.sh
#
# This compose is for optional/alternative Docker-based services only.
# Main compose: ~/Documents/Projects/docker-compose.yml (GYST backends)
# Embeddings: ~/.claude-dash/embeddings-server/docker-compose.yml

services:
  # ===================
  # INDEXING DAEMON (Python - Optional)
  # Background indexer using SQLite - use profile: indexer
  # ===================
  indexing-daemon:
    image: python:3.11-slim
    container_name: indexing-daemon
    working_dir: /app/mlx-tools
    command: python indexing_daemon.py watch
    volumes:
      - ../mlx-tools:/app/mlx-tools:ro
      - ../config.json:/app/claude-memory/config.json:ro
      - ../projects:/app/claude-memory/projects
      - ../memory.db:/app/claude-memory/memory.db
      - ../indexes:/app/claude-memory/indexes
      - ../logs:/app/claude-memory/logs
      - ${PROJECTS_ROOT:-/Users/jmelendez/Documents/Projects}:/data/projects:ro
    environment:
      - MEMORY_ROOT=/app/claude-memory
      - PROJECTS_ROOT=/data/projects
    profiles:
      - indexer  # Optional: docker-compose --profile indexer up
    restart: unless-stopped

networks:
  default:
    name: claude-memory-network
